import Q1
import BTree
import List
import Cp
import Data.List
import LTree

isValidMagicNr = hyloLTree (either id and) eqSep .
                            cataBlockchain (either (singl . p1) (cons. (p1 >< id)))

eqSep = either (i1.true) 
            (cond ((False==).p1) (i1.p1) (i2.p2) . uncurry finders) 
                    . outList
      
finders = segment fr fgene basef where
    fgene = const.const.const (False,([],[]))
    fr = id
    basef = const (True,([],[]))



